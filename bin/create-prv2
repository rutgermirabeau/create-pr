#!/usr/bin/env bash

function usage() {
  echo "Quickly create a PR from the current staging area in Github."
  echo "If the current branch is master, a new branch will be created for the PR."
  echo "If the current branch is not master, the PR will merge the current branch to master."
  echo ""
  echo "Options:"
  echo "-a         add all files to the PR instead of the files added to the staging area"
  echo "-m [msg]   provide a commit and PR message, default: quick pr"
  echo "-s         switch back to master after creating the PR."
  echo ""
  echo "Example:"
  echo "create-pr -as -m \"Some small changes the the README\""
}

if [ "$*" == "--help" ] || [ "$*" = "-h" ]
then
  usage
  exit
fi

ALL=0
MESSAGE="quick pr"
SWITCH_TO_MASTER=0

while getopts asm: option
do
case "${option}"
in
a) ALL=1;;
m) MESSAGE=${OPTARG};;
s) SWITCH_TO_MASTER=1;;
*) usage; exit 0;;
esac
done

echo "ALL=$ALL"
echo "MESSAGE=$MESSAGE"
echo "SWITCH_TO_MASTER=$SWITCH_TO_MASTER"
echo ""
usage